<?php

namespace App\Service;

use Symfony\Component\HttpClient\HttpClient;


class CallAPI
{
   private $client;

   public function __construct()
   {
       $this->client = HttpClient::create([], 10);
   }

   public function fetchAllCreatures(): array
   {
       $response = $this->client->request(
           'GET',
           $_ENV['API_URL'].'/seacreatures'
       );

       $statusCode = $response->getStatusCode();
       // $statusCode = 200
       $contentType = $response->getHeaders()['content-type'][0];
       // $contentType = 'application/json'
       $content = $response->getContent();
       // $content = '{"id":521583, "name":"symfony-docs", ...}'
       $content = $response->toArray();
       // $content = ['id' => 521583, 'name' => 'symfony-docs', ...]

       return $content;
   }

   public function fetchOneCreature($creature_id): array
   {
       $response = $this->client->request(
           'GET',
           $_ENV['API_URL'].'/seacreature/'.$creature_id
       );

       $statusCode = $response->getStatusCode();
       $contentType = $response->getHeaders()['content-type'][0];
       $content = $response->getContent();
       $content = $response->toArray();
       if (isset($content[0]))
        return $content[0];
       else
        return array();
   }

   public function deleteOneCreature($creature_id): string
   {
       $response = $this->client->request(
           'GET',
           $_ENV['API_URL'].'/seacreature/'.$creature_id.'/delete'
       );

       $statusCode = $response->getStatusCode();
       // $statusCode = 200
       $contentType = $response->getHeaders()['content-type'][0];
       // $contentType = 'application/json'
       $content = $response->getContent();
       // $content = ['id' => 521583, 'name' => 'symfony-docs', ...]
       return 'success';
   }

   public function editOneCreature($creature_id, $creature_name, $creature_description, $creature_image, $creature_depth): string
   {
       $response = $this->client->request(
           'POST',
           $_ENV['API_URL'].'/seacreature/'.$creature_id.'/edit',
           ['json' => ['creature_name' => $creature_name, 'creature_description' => $creature_description, 'creature_image' => $creature_image, 'creature_depth' => $creature_depth]]
       );

       $statusCode = $response->getStatusCode();
       // $statusCode = 200
       $contentType = $response->getHeaders()['content-type'][0];
       // $contentType = 'application/json'
       $content = $response->getContent();
       // $content = ['id' => 521583, 'name' => 'symfony-docs', ...]
       return 'success';
   }

   public function addOneCreature($creature_name, $creature_description, $creature_image, $creature_depth): string
   {
       $response = $this->client->request(
           'POST',
           $_ENV['API_URL'].'/seacreature/add',
           ['json' => ['creature_name' => $creature_name, 'creature_description' => $creature_description, 'creature_image' => $creature_image, 'creature_depth' => $creature_depth]]
       );

       $statusCode = $response->getStatusCode();
       // $statusCode = 200
       $contentType = $response->getHeaders()['content-type'][0];
       // $contentType = 'application/json'
       $content = $response->getContent();
       // $content = ['id' => 521583, 'name' => 'symfony-docs', ...]
       return 'success';
   }

}
